<? 
//iniciamos la sesin 
session_name("loginUsuario"); 
session_start(); 

//antes de hacer los clculos, compruebo que el usuario est logueado 
//utilizamos el mismo script que antes 
if ($_SESSION["autentificado"] != "SI") { 
    //si no est logueado lo envo a la pgina de autentificacin 
    header("Location: index.php"); 
} else { 
    //sino, calculamos el tiempo transcurrido 
    $fechaGuardada = $_SESSION["ultimoAcceso"]; 
    $ahora = date("Y-n-j H:i:s"); 
    $tiempo_transcurrido = (strtotime($ahora)-strtotime($fechaGuardada)); 

    //comparamos el tiempo transcurrido 
     if($tiempo_transcurrido >= 600) { 
     //si pasaron 10 minutos o ms 
      session_destroy(); // destruyo la sesin 
      header("Location: index.php"); //envo al usuario a la pag. de autenticacin 
      //sino, actualizo la fecha de la sesin 
    }else { 
    $_SESSION["ultimoAcceso"] = $ahora; 
   } 
} 
?>